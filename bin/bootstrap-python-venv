#!/usr/bin/env bash
#
# Bootstrap virtual environment with missing Python packages.
#

VENV="${VIRTUAL_ENV:-$1}"
PYTHON="${VENV}/bin/python"

if [ ! -x "$PYTHON" ]; then
  echo "Python not found at $PYTHON"
  exit 1
fi

# pylsp
if ! "${VENV}/bin/pylsp" ; then
  "$PYTHON" -m pip install python-lsp-server[all] python-lsp-black pyls-isort
  "$PYTHON" -m pip install flake8 flake8-docstrings pydocstyle[toml]
fi

# pymacs and ropemacs
# if ! $PYTHON -c 'import Pymacs'; then
#   $PYTHON -m pip install -U pyopenssl
#   $PYTHON -m pip install -e ~/.config/emacs/straight/repos/Pymacs/
# fi

# if ! $PYTHON -c 'import rope'; then
#   $PYTHON -m pip install -U rope
# fi

# if ! $PYTHON -c 'import ropemacs'; then
#   $PYTHON -m pip install -e ~/.config/emacs/straight/repos/ropemacs/
# fi
